<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 利用canvas进行 最大邻域法 图像放大 · HanDong's Blog</title><meta name="description" content="利用canvas进行 最大邻域法 图像放大 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/sunchongsheng" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/pinggod" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">利用canvas进行 最大邻域法 图像放大</h1><div class="post-time">Sep 14, 2012</div><div class="post-content"><p>利用html5中的canvas可以进行在线图片处理，下面以放大图片为例来介绍基本方法。</p>
<p>图片放大可以用很多插值方法，比如在html中指定img元素的width属性时，浏览器会自动对其进行插值放大。但一些时候我们需要自定义的插值放大方法，比如下面的链接演示了雷达回波图片的放大，采用了基本的最大邻域法来进行放大，这时需要我们自己来写算法。</p>
<p>先看演示：<a href="http://grow.sinaapp.com/wp-content/topic/scale-img/" title="打开链接" target="_blank" rel="external">雷达回波图采用最大邻域法来进行放大</a></p>
<p>下面是主要的两个处理函数：</p>
<pre lang="javascript">

//获取图片像素信息
var getImagePixelData = function(img){
    var canvas = $('<canvas>')[0];
    canvas.width = img.width;
    canvas.height = img.height;

    var context = canvas.getContext('2d');//获取2D绘制上下文context 原生API

    context.drawImage(img, 0, 0);//在context中绘制图片 原生API

    return context.getImageData(0,0,img.width, img.height);//获取context中的像素数据 原生API
}

//利用包含图片像素数据的对象imageData 获取 放大后的对象newImageData
var scaleImage = function(imageData, newImageData){

    var ow = imageData.width, oh = imageData.height;

    var scalew = newImageData.width/ow,
    scaleh = newImageData.height/oh;

    var se1, se2, se3;

    var pos = 0, pos2 = 0;

    for(var y = 0; y < oh; y++){
        for(var x = 0; x < ow; x++){

            if(imageData.data[pos+3]){
                for(var ny = Math.floor(y*scaleh); ny < Math.floor((y+1)*scaleh); ny++){
                    for(var nx = Math.floor(x*scalew); nx < Math.floor((x+1)*scalew); nx++){
                        pos2 = (ny*newImageData.height + nx)*4;
                        newImageData.data[pos2] = imageData.data[pos];
                        newImageData.data[pos2+1] = imageData.data[pos+1];
                        newImageData.data[pos2+2] = imageData.data[pos+2];
                        newImageData.data[pos2+3] = imageData.data[pos+3];
                    }
                }

            }
            pos += 4;
        }
    }

    return newImageData;
}
</canvas></pre></div></article></div></section><footer><div class="paginator"><a href="/2012/12/20/e5-9c-a8-e7-ba-bf-e6-9f-a5-e8-af-a2-e5-90-84-e7-9c-81-e6-9c-80-e6-96-b0-e7-9a-84-e9-99-8d-e9-9b-aa-e9-87-8f/" class="prev">上一篇</a><a href="/2012/09/12/svn-e5-91-bd-e4-bb-a4-e8-af-a6-e8-a7-a3/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://blog.tianqi.at">John Doe</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?a36e15d9e2adec9a21fcdd9f686b1ed2";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>