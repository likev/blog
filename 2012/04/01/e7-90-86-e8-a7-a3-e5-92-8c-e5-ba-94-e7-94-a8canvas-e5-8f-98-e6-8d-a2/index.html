<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 理解和应用canvas变换 · HanDong's Blog</title><meta name="description" content="理解和应用canvas变换 - John Doe"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/html5-audio-player/" target="_self" class="nav-list-link">MUSIC</a></li><li class="nav-list-item"><a href="https://twitter.com/likev" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="https://github.com/likev" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">理解和应用canvas变换</h1><div class="post-time">Apr 1, 2012</div><div class="post-content"><p>默认的canvas画布以左上角为原点，向右为x轴增长方向，向下为y轴增长方向。默认以像素为单位。</p>
<p>很多情况下使用默认绘图环境极为不便，默认坐标系与我们上学时经常用到的直角坐标系不太一致。</p>
<p>幸运的是我们可以利用为canvas提供的变换函数来进行坐标转换，比如将原点移动到画布中心，转换Y轴方向等。<br>当调用一个变换函数时，接下来的绘图将自动变换。所以变换前应该先将当前环境保存下来，执行完绘图时恢复之前的环境。<br>save()和restore()两个函数用来保存和恢复环境。</p>
<p>下面说一下常用的变换函数：</p>
<p>1. 平移函数 translate(dx, dy)<br>调用此函数后接下来的绘图x值自动增加dx，y值自动增加dy。效果就是平移一个绘图，也就是所有点都进行了平移。这也是改变原点的办法。</p>
<p>2. 旋转函数 rotate(angle)<br>调用此函数后接下来的绘图将沿原点顺时针方向旋转angle弧度</p>
<p>3. 缩放函数 scale(a, b)<br>调用此函数后x坐标值将缩放a倍，y坐标将缩放b倍。效果是整个绘图放大或缩小了。<br>a和b的值可以为负值，比如 scale(1, -1)的效果是转换y轴的方向(向下变为向上)。</p>
<p>还有两个矩阵变换函数transform / setTransform。它们稍微复杂些，先不介绍。</p>
<p>上面那些变换函数可以一起使用，但你心中要明白每一步操作有什么影响。</p>
<p>回到开头的问题，比如我们想将原点移动到(300,400)这个点，然后使y轴方向向上，可以这么做：</p>
<pre lang="javascript">
    dc.translate(300, 400);
    dc.scale(1,-1);
</pre>
接下来的绘图就是你熟悉的在直角坐标系下的绘图了。

当绘制正弦函数sin(x)时，由于y值最大为1，x的范围一般为2*π ，这时可以利用缩放函数scale对x轴和y轴进行放大。
又比如我们的数据值是在(1000,3000)附近，这时可以在设置好坐标后对坐标进行平移，使(1000,3000)这个点在画布中央。
<pre lang="javascript">
    dc.translate(300, 400);
    dc.scale(1,-1);
    dc.translate(-1000, -3000);
</pre>

<p>相关链接：1.<a href="https://developer.mozilla.org/cn/Canvas_tutorial" target="_blank" rel="external">canvas基础教程</a></p>
</div></article></div></section><footer><div class="paginator"><a href="/2012/04/09/javascript-e4-b8-ad-e7-b1-bb-e7-9a-84-e5-ae-9e-e7-8e-b0-e6-96-b9-e5-bc-8f-e4-b9-8b-e4-b8-80/" class="prev">PRVE</a><a href="/2012/03/26/windows-e4-b8-ad-e7-9a-84-e5-a4-9a-e7-ba-bf-e7-a8-8b-e5-a4-84-e7-90-86/" class="next">NEXT</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://blog.tianqi.at">John Doe</a>, unless otherwise noted.</p></div></footer><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>