<!DOCTYPE html><html lang="zh-cn,en,default"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Sina App Engine(SAE)中的Mysql服务限制说明 · HanDong's Blog</title><meta name="description" content="Sina App Engine(SAE)中的Mysql服务限制说明 - HanDong"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="http://fonts.useso.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="/html5-audio-player/" target="_self" class="nav-list-link">MUSIC</a></li><li class="nav-list-item"><a href="https://twitter.com/likev" target="_blank" class="nav-list-link">TWITTER</a></li><li class="nav-list-item"><a href="https://github.com/likev" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Sina App Engine(SAE)中的Mysql服务限制说明</h1><div class="post-time">2011年11月23日</div><div class="post-content"><p>Mysql服务概要 </p>
<pre><code>SAE平台为每个App支持几乎所有MySQL的特性。目前支持MyISAM引擎，暂不支持InnoDB。需要注意的是SAE的数据库需要显式开启或者禁用。您还可以通过phpmyadmin来创建数据库和数据表。SAE的PHP环境提供了标准的MYSQL,MYSQLI和PDO模块(基于MySQLnd)，您可以直接使用这三个模块来操作您的数据库， 您可以使用预定义常量来连接数据库，我们不排除未来可能调整数据库端口，使用预定义常量能够避免这样的问题。当然SAE也提供了SaeMysql类，我们也推荐您使用这个类来操作MySQL资源。
</code></pre><p>服务限制</p>
<table cellspacing="1" cellpadding="1" style="width: 600px"><br>            <tbody><br>                <tr><br>                    <td>限制</td><br>                    <td>相关错误信息</td><br>                    <td>数值</td><br>                </tr><br>                <tr><br>                    <td>单表的最大行数</td><br>                    <td>Table too many rows</td><br>                    <td>10 000 000 行</td><br>                </tr><br>                <tr><br>                    <td>库的最大表数量</td><br>                    <td>Too many tables</td><br>                    <td>512个</td><br>                </tr><br>                <tr><br>                    <td>不支持的存储引擎类型</td><br>                    <td>Not support table type</td><br>                    <td>memory temporary</td><br>                </tr><br>                <tr><br>                    <td>最大外排序的行数</td><br>                    <td>Filesort on too many rows</td><br>                    <td>65536 行</td><br>                </tr><br>                <tr><br>                    <td>最大无索引的操作行数</td><br>                    <td>无</td><br>                    <td>100 000 行</td><br>                </tr><br>                <tr><br>                    <td>查询的最大操作行数</td><br>                    <td>Select on too many rows</td><br>                    <td>1 000 000 行</td><br>                </tr><br>                <tr><br>                    <td>更新的最大操作行数</td><br>                    <td>Update on too many rows</td><br>                    <td>1 000 000 行</td><br>                </tr><br>                <tr><br>                    <td>删除的最大操作行数</td><br>                    <td>Delete on too many rows</td><br>                    <td>1 000 000 行</td><br>                </tr><br>                <tr><br>                    <td>创建索引时允许的表的最大行数</td><br>                    <td>Create index on big table</td><br>                    <td>500 000 行</td><br>                </tr><br>                <tr><br>                    <td>修改表结构时允许的表的最大行数</td><br>                    <td>Alter table on big table</td><br>                    <td>500 000 行</td><br>                </tr><br>                <tr><br>                    <td>SQL并发执行时间和(读库)</td><br>                    <td>Operations take too much time cost</td><br>                    <td>500 000 毫秒</td><br>                </tr><br>                <tr><br>                    <td>SQL并发执行时间和(写库)</td><br>                    <td>Operations take too much time cost</td><br>                    <td>200 000 毫秒</td><br>                </tr><br>                <tr><br>                    <td>警报阈值百分比</td><br>                    <td>无</td><br>                    <td>80%</td><br>                </tr><br>                <tr><br>                    <td>表主键及聚簇索引奖励系数</td><br>                    <td>无</td><br>                    <td>1024 倍</td><br>                </tr><br>            </tbody><br>        </table>

<p> MySQL慢查询配额</p>
<p>SQL执行时间超过1秒，即为慢查询，其分钟配额为<br>条目数     10<br>累计执行时间     30秒<br>扫描行     1,000,000</p>
<p> 分钟配额<br>    运行在SAE上的应用(App)将会消耗平台资源，为保证各App不互相影响，我们引入了分钟配额的概念，即：在每分钟内每个应用的各个服务所消耗的 资源的速度。比如，当平台中的某个应用的MySQLl服务一分钟内累计请求数达到20万，或者流出宽带超过600M，或者累计CPU执行时间超过400s，我们将会立即禁掉该应用的MySQL服务，禁用五分钟后，恢复会自动恢复，避免影响到SAE平台的稳定性。服务因为超过“分钟配额”而被禁用时，会在“服务状态”看到该服务被禁用的原因。</p>
<p>注意：表中红色配额值是自2011-11-3号，即SAE两周年起开始执行的新配额值，旧配额值将不再采用。</p>
<table style="width: 578px; height: 316px" class="quota"><br>    <tbody><br>        <tr><br>            <td>服务</td><br>            <td>请求数</td><br>            <td>cpu时间</td><br>            <td>流入流量</td><br>            <td>流出流量</td><br>        </tr><br>        <tr><br>            <td>HTTP</td><br>            <td>200,000=&gt;<font color="#FF0000">500,000</font></td><br>            <td>300s=&gt;<font color="#FF0000">600s</font></td><br>            <td>300MB=&gt;<font color="#FF0000">1500MB</font></td><br>            <td>300MB=&gt;<font color="#FF0000">1500MB</font></td><br>        </tr><br>        <tr><br>            <td>HTTPS</td><br>            <td>50,000=&gt;<font color="#FF0000">1,000,000</font></td><br>            <td>50s=&gt;<font color="#FF0000">100s</font></td><br>            <td>10MB=&gt;<font color="#FF0000">100MB</font></td><br>            <td>10MB=&gt;<font color="#FF0000">100MB</font></td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=192">MySQL</a></td><br>            <td>200,000</td><br>            <td>400s=&gt;<font color="#FF0000">600s</font></td><br>            <td>300MB=&gt;<font color="#FF0000">600MB</font></td><br>            <td>600MB=&gt;<font color="#FF0000">1200MB</font></td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=201">Memcache</a></td><br>            <td>300,000</td><br>            <td>NA</td><br>            <td>150MB=&gt;<font color="#FF0000">300MB</font></td><br>            <td>150MB=&gt;<font color="#FF0000">300MB</font></td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=197">Fetchurl</a></td><br>            <td>50,000=&gt;<font color="#FF0000">100,000</font></td><br>            <td>NA</td><br>            <td>100MB=&gt;<font color="#FF0000">200MB</font></td><br>            <td>100MB=&gt;<font color="#FF0000">200MB</font></td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=198">Image</a></td><br>            <td>5,000</td><br>            <td>300s</td><br>            <td>150MB</td><br>            <td>150MB</td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=204">Storage</a></td><br>            <td>5,000</td><br>            <td>NA</td><br>            <td>50MB=&gt;<font color="#FF0000">80MB</font></td><br>            <td>400MB</td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=200">Mail</a></td><br>            <td>50=&gt;<font color="#FF0000">500</font></td><br>            <td>NA</td><br>            <td>20MB</td><br>            <td>20MB</td><br>        </tr><br>        <tr><br>            <td>Cron/offset</td><br>            <td>50</td><br>            <td>50s</td><br>            <td>1MB</td><br>            <td>1MB</td><br>        </tr><br>        <tr><br>            <td>Cron/nooffset</td><br>            <td>200</td><br>            <td>30s=&gt;<font color="#FF0000">60s</font></td><br>            <td>5MB</td><br>            <td>5MB</td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=205">TaskQueue</a></td><br>            <td>20,000=&gt;<font color="#FF0000">40,000</font></td><br>            <td>60s=&gt;<font color="#FF0000">100s</font></td><br>            <td>10MB=&gt;<font color="#FF0000">20MB</font></td><br>            <td>10MB=&gt;<font color="#FF0000">20MB</font></td><br>        </tr><br>        <tr><br>            <td>VerifyCode</td><br>            <td>100</td><br>            <td>4s</td><br>            <td>2MB</td><br>            <td>2MB</td><br>        </tr><br>        <tr><br>            <td><a href="/?m=devcenter&amp;catId=199">KVDB</a></td><br>            <td>150,000=&gt;<font color="#FF0000">300,000</font></td><br>            <td>NA</td><br>            <td>150MB=&gt;<font color="#FF0000">300MB</font></td><br>            <td>150MB=&gt;<font color="#FF0000">300MB</font></td><br>        </tr><br>    </tbody><br></table>

<p>容量配额</p>
<pre><code>容量配额是针对MySQL\Storage\MemCache设置的，是指用户能够使用的磁盘或内存的最大限制(见下表)，其中Memcache的最大容量配额是用户自己在初始化Memcache时设置的，可设置的范围是1M~256M。
</code></pre><p>服务     配额<br>MySQL     5G<br>Storage     10G<em><br>KVDB     100G
</em>每个App允许建立5个Storage domain 每个domain为2G</p>
</div></article></div></section><footer><div class="paginator"><a href="/2011/11/25/jqplot-options-overview/" class="prev">上一篇</a><a href="/2011/11/15/e6-9f-a5-e7-9c-8b-e5-85-a8-e5-9b-bd-e5-90-84-e5-9c-b0-e5-a4-a9-e6-b0-94-e5-ae-9e-e5-86-b5-e4-bf-a1-e6-81-af/" class="next">下一篇</a></div><div class="copyright"><p>© 2015 - 2016 <a href="http://blog.tianqi.at">HanDong</a>, unless otherwise noted.</p></div></footer><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script></body></html>